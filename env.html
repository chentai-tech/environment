
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>全泰科技環境打掃登錄系統</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>
<body>
    <div class="container mt-5">
        <div class="row">
            <div class="col-8 mx-auto">
                <h1 class="mb-5 text-center">全泰科技<br>環境打掃登錄系統</h1>
				<h2 class="mb-3 text-center" id="datetime"></h2>
                <form action="post" id="google-sheet">
					<script>
						// 開啟環境打掃表單新分頁
						function visitPage() {
							window.open('https://docs.google.com/spreadsheets/d/1rvy5TS6xvCGU9yonexAeLh0-8tufJM1RpdqVoucgPeM/edit#gid=0');
						}
					</script>
                    <div class="mb-3">
                        <label for="Name" class="form-label">姓名</label>
                        <input type="text" class="form-control" id="name" placeholder="您的姓名" name="Name" required>
                    </div>
                    <div class="mb-3 d-block">
                        <input type="submit" class="btn btn-primary btn-lg w-100 mt-5" value="送出表單" />
                    </div>
					<div class="mb-3 d-block">
                        <input type="button" class="btn btn-primary btn-lg w-100 mt-5" value="檢視列表" onclick="visitPage();" />
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.js'></script>
    <script src="env.js"></script>
	<script>
		function getHowManyWeeks(){
            let totalDays = 0,//總天數
                i = 1;//預設開始為第1個月
			Let Y = new Date().getYear(),
				M = new Date().getMonth(),
				D = new Date().getDate();
            for(; i < M ; i++){//計算總天數
                totalDays += new Date(Y, M, 0).getDate();
            }

            totalDays += parseInt(D);

            return Math.ceil(totalDays/7);  //除以7，向上取整數，計算第幾週

        }

		// Insert date and time into HTML
		document.getElementById("datetime").innerHTML = '第'+getHowManyWeeks()+'週';
	</script>
</body>
</html>